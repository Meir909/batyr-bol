<!DOCTYPE html>
<html lang="ru" class="scroll-smooth">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#f59e0b">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="BATYR BOL">
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="logo.png">
  <title>BATYR BOL ‚Äî –ò–≥—Ä–∞</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
  <script src="auth.js"></script>
  <script src="achievements.js"></script>
  <script src="daily_rewards.js"></script>
  <script src="leaderboard.js"></script>
  <script src="user_stats.js"></script>
  <script src="voice_recognition.js"></script>
  <script src="game_integration.js"></script>
  <script src="game_engine.js"></script>

  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            gold: {
              50: '#fffbeb',
              100: '#fef3c7',
              200: '#fde68a',
              300: '#fcd34d',
              400: '#fbbf24',
              500: '#f59e0b',
              600: '#d97706',
              700: '#b45309',
              800: '#92400e',
              900: '#78350f',
              950: '#451a03',
            }
          }
        }
      }
    }
  </script>

  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', ui-sans-serif, system-ui, -apple-system, sans-serif;
      background: linear-gradient(135deg, #0a0a0a 0%, #111111 50%, #0a0a0a 100%);
      color: #e4e4e7;
      min-height: 100vh;
    }

    body[data-language="ru"] .lang-kz {
      display: none !important;
    }

    body[data-language="kz"] .lang-ru {
      display: none !important;
    }

    .glass {
      background: rgba(24, 24, 27, 0.6);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.08);
    }

    .card-hover {
      transition: all 0.3s ease;
    }

    .card-hover:hover {
      transform: translateY(-2px);
      box-shadow: 0 20px 40px rgba(245, 158, 11, 0.1);
      border-color: rgba(245, 158, 11, 0.3);
    }

    .glow {
      box-shadow: 0 0 30px rgba(245, 158, 11, 0.2);
    }

    .btn-primary {
      background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
      color: #000;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .btn-primary:hover {
      transform: scale(1.02);
      box-shadow: 0 10px 30px rgba(245, 158, 11, 0.3);
    }

    .progress-bar {
      background: linear-gradient(90deg, #f59e0b 0%, #fbbf24 100%);
    }

    ::-webkit-scrollbar {
      width: 6px;
    }

    ::-webkit-scrollbar-track {
      background: #0a0a0a;
    }

    ::-webkit-scrollbar-thumb {
      background: #27272a;
      border-radius: 3px;
    }

    @keyframes pulse-gold {

      0%,
      100% {
        box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4);
      }

      50% {
        box-shadow: 0 0 0 10px rgba(245, 158, 11, 0);
      }
    }

    .pulse-gold {
      animation: pulse-gold 2s infinite;
    }

    @keyframes float {

      0%,
      100% {
        transform: translateY(0);
      }

      50% {
        transform: translateY(-5px);
      }
    }

    .float {
      animation: float 3s ease-in-out infinite;
    }
  </style>
</head>

<body class="antialiased" data-language="kz">

  <!-- AUTH SCREEN -->
  <section id="auth" class="min-h-screen flex items-center justify-center p-6">
    <div class="w-full max-w-md">
      <!-- Logo -->
      <div class="text-center mb-10">
        <div class="inline-block float">
          <img src="logo.png" alt="BATYR BOL" class="w-24 h-24 mx-auto rounded-2xl glow">
        </div>
        <h1 class="text-3xl font-bold text-white mt-6 tracking-tight">BATYR BOL</h1>
        <p class="text-zinc-500 mt-2">
          <span class="lang-ru">–ò–∑—É—á–∞–π –∏—Å—Ç–æ—Ä–∏—é –∏–≥—Ä–∞—è</span>
          <span class="lang-kz">–û–π–Ω–∞–π –æ—Ç—ã—Ä—ã–ø —Ç–∞—Ä–∏—Ö—Ç—ã “Ø–π—Ä–µ–Ω</span>
        </p>
      </div>

      <!-- Auth Card -->
      <div class="glass rounded-3xl p-8">
        <!-- Important Notice -->
        <div class="bg-yellow-900/30 border border-yellow-500/30 rounded-lg p-4 mb-6">
          <p class="text-yellow-300 text-sm font-medium text-center">
            <span class="lang-ru">‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω–∞</span>
            <span class="lang-kz">‚ö†Ô∏è –ï–°–ö–ï–†–¢–£: –¢—ñ—Ä–∫–µ–ª—É —É–∞“õ—ã—Ç—à–∞ ”©—à—ñ—Ä—ñ–ª–≥–µ–Ω</span><br>
            <span class="lang-ru">–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ —Ç–µ—Å—Ç–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç –¥–ª—è –≤—Ö–æ–¥–∞</span>
            <span class="lang-kz">–¢–µ–∫ —Å—ã–Ω–∞“õ –∞–∫–∫–∞—É–Ω—Ç—ã–Ω “ì–∞–Ω–∞ –ø–∞–π–¥–∞–ª–∞–Ω—ã“£—ã–∑</span>
          </p>
        </div>

        <!-- Tabs -->
        <div class="flex gap-2 mb-8 p-1 bg-zinc-900/50 rounded-xl">
          <button onclick="showTab('login')" id="tab-login"
            class="flex-1 py-2.5 text-sm font-medium rounded-lg bg-gold-500 text-black transition-all">
            <span class="lang-ru">–í—Ö–æ–¥</span>
            <span class="lang-kz">–ö—ñ—Ä—É</span>
          </button>
          <button onclick="showTab('register')" id="tab-register"
            class="flex-1 py-2.5 text-sm font-medium rounded-lg text-zinc-400 transition-all">
            <span class="lang-ru">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</span>
            <span class="lang-kz">–¢—ñ—Ä–∫–µ–ª—É</span>
          </button>
        </div>

        <!-- Login Form -->
        <form id="login-form" class="space-y-5">
          <div class="bg-green-900/30 border border-green-500/30 rounded-lg p-4 mb-4">
            <p class="text-green-300 text-sm font-medium">
              <span class="lang-ru">‚úÖ –î–û–°–¢–£–ü–ù–´–ô –ê–ö–ö–ê–£–¢:</span>
              <span class="lang-kz">‚úö “ö–û–õ–ñ–ï–¢–Ü–ù –ê–ö–ö–ê–£–ù–¢:</span><br>
            <div class="mt-2 space-y-1">
              <div><span class="lang-ru">Email:</span> <code class="text-green-200 font-mono">test@batyrbol.kz</code>
              </div>
              <div><span class="lang-ru">–ü–∞—Ä–æ–ª—å:</span> <code class="text-green-200 font-mono">batyr123</code></div>
            </div>
            <p class="text-xs text-green-400 mt-2">
              <span class="lang-ru">üìù –ü–æ–ª—è —É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã - –ø—Ä–æ—Å—Ç–æ –Ω–∞–∂–º–∏—Ç–µ "–í–æ–π—Ç–∏"</span>
              <span class="lang-kz">üìù ”®—Ä—ñ—Å—Ç–µ—Ä —Ç–æ–ª—Ç—ã—Ä—ã–ª“ì–∞–Ω - —Ç–µ–∫ "–ö—ñ—Ä—É–¥—ñ" –±–∞—Å—ã“£—ã–∑</span>
            </p>
            </p>
          </div>
          <div>
            <label class="block text-sm text-zinc-400 mb-2">
              <span class="lang-ru">Email</span>
              <span class="lang-kz">Email</span>
            </label>
            <input type="email" id="login-email" required
              class="w-full px-4 py-3.5 bg-zinc-900/50 border border-white/10 rounded-xl text-white placeholder-zinc-600 focus:border-gold-500/50 focus:outline-none transition-colors"
              placeholder="test@batyrbol.kz" value="test@batyrbol.kz" readonly>
          </div>
          <div>
            <label class="block text-sm text-zinc-400 mb-2">
              <span class="lang-ru">–ü–∞—Ä–æ–ª—å</span>
              <span class="lang-kz">“ö“±–ø–∏—è —Å”©–∑</span>
            </label>
            <input type="password" id="login-password" required
              class="w-full px-4 py-3.5 bg-zinc-900/50 border border-white/10 rounded-xl text-white placeholder-zinc-600 focus:border-gold-500/50 focus:outline-none transition-colors"
              placeholder="batyr123" value="batyr123" readonly>
          </div>
          <button type="submit" class="w-full py-4 btn-primary rounded-xl text-base font-medium">
            <span class="lang-ru">üéÆ –í–æ–π—Ç–∏ –≤ –∏–≥—Ä—É</span>
            <span class="lang-kz">üéÆ –û–π—ã–Ω“ì–∞ –∫—ñ—Ä—É</span>
          </button>
        </form>

        <!-- Register Form -->
        <form id="register-form" class="space-y-5 hidden">
          <div class="bg-red-900/30 border border-red-500/30 rounded-lg p-4 mb-4">
            <p class="text-red-300 text-sm font-medium text-center">
              <span class="lang-ru">‚ùå –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –û–¢–ö–õ–Æ–ß–ï–ù–ê</span>
              <span class="lang-kz">‚ùå –¢–Ü–†–ö–ï–õ–£ ”®–®–Ü–†–Ü–õ–ì–ï–ù</span><br>
              <span class="lang-ru">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç –¥–ª—è –≤—Ö–æ–¥–∞</span>
              <span class="lang-kz">–ö—ñ—Ä—É “Ø—à—ñ–Ω —Å—ã–Ω–∞“õ –∞–∫–∫–∞—É–Ω—Ç—ã–Ω –ø–∞–π–¥–∞–ª–∞–Ω—ã“£—ã–∑</span>
            </p>
          </div>

          <div class="text-center py-8">
            <div class="text-zinc-500 text-lg mb-4">
              <span class="lang-ru">üîí –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ</span>
              <span class="lang-kz">üîí –ñ–∞“£–∞ –∞–∫–∫–∞—É–Ω—Ç—Ç–∞—Ä–¥—ã –∂–∞—Å–∞—É —É–∞“õ—ã—Ç—à–∞ “õ–æ–ª –∂–µ—Ç—ñ–º—Å—ñ–∑</span>
            </div>
            <button type="button" onclick="showTab('login')"
              class="px-6 py-3 bg-gold-500 text-black rounded-lg font-medium hover:bg-gold-400 transition-colors">
              <span class="lang-ru">üîÑ –ü–µ—Ä–µ–π—Ç–∏ –∫–æ –≤—Ö–æ–¥—É</span>
              <span class="lang-kz">üîÑ –ö—ñ—Ä—É–≥–µ ”©—Ç—É</span>
            </button>
          </div>
        </form>
      </div>

      <!-- Language Switch -->
      <div class="flex justify-center gap-2 mt-8">
        <button onclick="switchLanguage('ru')" id="btn-ru"
          class="px-4 py-2 text-sm font-medium rounded-lg bg-zinc-800 text-zinc-400 hover:text-white transition-colors">RU</button>
        <button onclick="switchLanguage('kz')" id="btn-kz"
          class="px-4 py-2 text-sm font-medium rounded-lg bg-gold-500 text-black">KZ</button>
      </div>
    </div>
  </section>

  <!-- GAME SCREEN -->
  <section id="game" class="hidden min-h-screen">
    <!-- Header -->
    <header class="sticky top-0 z-50 glass border-b border-white/5">
      <div class="max-w-7xl mx-auto px-6 h-16 flex items-center justify-between">
        <div class="flex items-center gap-3">
          <img src="logo.png" alt="BATYR BOL" class="w-10 h-10 rounded-xl">
          <span class="text-xl font-bold text-white tracking-tight">BATYR BOL</span>
        </div>

        <div class="flex items-center gap-4">
          <!-- Energy Bar -->
          <div id="energy-container"
            class="hidden md:flex items-center gap-3 mr-4 px-4 py-2 bg-zinc-900/80 rounded-xl border border-white/10">
            <iconify-icon icon="lucide:battery-charging" class="text-green-400" width="18"></iconify-icon>
            <div class="w-24 h-2 bg-zinc-800 rounded-full overflow-hidden">
              <div id="energy-bar"
                class="h-full bg-gradient-to-r from-green-500 to-green-400 rounded-full transition-all duration-300"
                style="width: 100%"></div>
            </div>
            <span id="energy-text" class="text-white text-sm font-semibold">20/20</span>
          </div>

          <!-- Quick Stats -->
          <div class="hidden md:flex items-center gap-4 mr-2">
            <div class="flex items-center gap-2">
              <iconify-icon icon="lucide:zap" class="text-gold-400" width="18"></iconify-icon>
              <span id="header-xp" class="text-white font-semibold">0</span>
            </div>
            <div class="flex items-center gap-2">
              <iconify-icon icon="lucide:flame" class="text-orange-400" width="18"></iconify-icon>
              <span id="header-streak" class="text-white font-semibold">0</span>
            </div>
          </div>

          <!-- Language -->
          <div class="flex gap-1 p-1 bg-zinc-900/80 rounded-lg border border-white/10">
            <button onclick="switchLanguage('ru')" id="btn-ru-game"
              class="px-3 py-1.5 text-xs font-medium rounded-md text-zinc-400 hover:text-white transition-colors">RU</button>
            <button onclick="switchLanguage('kz')" id="btn-kz-game"
              class="px-3 py-1.5 text-xs font-medium rounded-md bg-gold-500 text-black">KZ</button>
          </div>

          <!-- Feedback Button -->
          <button onclick="openFeedbackForm()" class="p-2.5 rounded-xl bg-blue-600 hover:bg-blue-700 transition-colors"
            title="–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å">
            <iconify-icon icon="lucide:message-square" class="text-blue-200" width="18"></iconify-icon>
          </button>

          <!-- Profile -->
          <button onclick="openProfileModal()"
            class="w-10 h-10 rounded-xl overflow-hidden border-2 border-gold-500/50 hover:border-gold-500 transition-colors">
            <img id="header-avatar" src="logo.png" alt="Avatar" class="w-full h-full object-cover">
          </button>

          <button onclick="logout()" class="p-2.5 rounded-xl bg-zinc-800 hover:bg-zinc-700 transition-colors">
            <iconify-icon icon="lucide:log-out" class="text-zinc-400" width="18"></iconify-icon>
          </button>
        </div>
      </div>
    </header>

    <!-- Messages Container -->
    <div id="game-messages" class="max-w-7xl mx-auto px-6 py-2">
      <!-- Messages will appear here -->
    </div>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-6 py-8">
      <div class="grid lg:grid-cols-12 gap-8">

        <!-- Sidebar -->
        <aside class="lg:col-span-3 space-y-6">
          <!-- Profile Card -->
          <div class="glass rounded-2xl p-6 card-hover">
            <div class="text-center">
              <div class="relative inline-block">
                <div class="w-20 h-20 rounded-2xl overflow-hidden border-2 border-gold-500/50 mx-auto">
                  <img id="user-avatar" src="logo.png" alt="Avatar" class="w-full h-full object-cover">
                </div>
                <div
                  class="absolute -bottom-1 -right-1 w-7 h-7 bg-gold-500 rounded-lg flex items-center justify-center text-black text-xs font-bold"
                  id="user-level-badge">1</div>
              </div>
              <h3 id="user-name" class="text-white font-bold text-lg mt-4">–ë–∞—Ç—ã—Ä</h3>
              <p class="text-gold-400 text-sm mt-1">
                <span class="lang-ru">–£—Ä–æ–≤–µ–Ω—å</span>
                <span class="lang-kz">–î–µ“£–≥–µ–π</span>
                <span id="user-level">1</span>
              </p>
            </div>

            <!-- XP Progress -->
            <div class="mt-6">
              <div class="flex justify-between text-xs mb-2">
                <span class="text-zinc-500">XP</span>
                <span class="text-gold-400 font-medium"><span id="user-xp">0</span> / 100</span>
              </div>
              <div class="h-2 bg-zinc-800 rounded-full overflow-hidden">
                <div id="xp-bar" class="h-full progress-bar rounded-full transition-all" style="width: 0%"></div>
              </div>
            </div>
          </div>

          <!-- Stats Grid -->
          <div class="grid grid-cols-2 gap-3">
            <div class="glass rounded-xl p-4 text-center card-hover">
              <iconify-icon icon="lucide:target" class="text-gold-400" width="24"></iconify-icon>
              <div id="stat-missions" class="text-white text-xl font-bold mt-2">0</div>
              <div class="text-zinc-500 text-xs mt-1">
                <span class="lang-ru">–ú–∏—Å—Å–∏–π</span>
                <span class="lang-kz">–ú–∏—Å—Å–∏—è</span>
              </div>
            </div>
            <div class="glass rounded-xl p-4 text-center card-hover">
              <iconify-icon icon="lucide:check-circle" class="text-green-400" width="24"></iconify-icon>
              <div id="stat-correct" class="text-white text-xl font-bold mt-2">0</div>
              <div class="text-zinc-500 text-xs mt-1">
                <span class="lang-ru">–í–µ—Ä–Ω—ã—Ö</span>
                <span class="lang-kz">–î“±—Ä—ã—Å</span>
              </div>
            </div>
            <div class="glass rounded-xl p-4 text-center card-hover">
              <iconify-icon icon="lucide:flame" class="text-orange-400" width="24"></iconify-icon>
              <div id="stat-streak" class="text-white text-xl font-bold mt-2">0</div>
              <div class="text-zinc-500 text-xs mt-1">
                <span class="lang-ru">–°–µ—Ä–∏—è</span>
                <span class="lang-kz">–°–µ—Ä–∏—è</span>
              </div>
            </div>
            <div class="glass rounded-xl p-4 text-center card-hover">
              <iconify-icon icon="lucide:trophy" class="text-purple-400" width="24"></iconify-icon>
              <div id="stat-achievements" class="text-white text-xl font-bold mt-2">0</div>
              <div class="text-zinc-500 text-xs mt-1">
                <span class="lang-ru">–ù–∞–≥—Ä–∞–¥—ã</span>
                <span class="lang-kz">–ú–∞—Ä–∞–ø–∞—Ç</span>
              </div>
            </div>
          </div>

          <!-- Quick Actions -->
          <div class="glass rounded-2xl p-4 space-y-2">
            <button onclick="openClanModal()"
              class="w-full flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-white/5 transition-colors text-left">
              <iconify-icon icon="lucide:users" class="text-blue-400" width="20"></iconify-icon>
              <span class="text-white text-sm font-medium">
                <span class="lang-ru">–ö–ª–∞–Ω—ã (–†—É)</span>
                <span class="lang-kz">–ö–ª–∞–Ω (–†—É)</span>
              </span>
            </button>
            <button onclick="openDuelModal()"
              class="w-full flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-white/5 transition-colors text-left">
              <iconify-icon icon="lucide:swords" class="text-red-400" width="20"></iconify-icon>
              <span class="text-white text-sm font-medium">
                <span class="lang-ru">–î—É—ç–ª–∏</span>
                <span class="lang-kz">–î—É—ç–ª—å</span>
              </span>
            </button>
            <button onclick="dailyRewards.showRewardModal()"
              class="w-full flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-white/5 transition-colors text-left">
              <iconify-icon icon="lucide:gift" class="text-gold-400" width="20"></iconify-icon>
              <span class="text-white text-sm font-medium">
                <span class="lang-ru">–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞</span>
                <span class="lang-kz">–ö“Ø–Ω–¥–µ–ª—ñ–∫—Ç—ñ —Å—ã–π–ª—ã“õ</span>
              </span>
            </button>
            <button onclick="leaderboard.showLeaderboardModal()"
              class="w-full flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-white/5 transition-colors text-left">
              <iconify-icon icon="lucide:trophy" class="text-gold-400" width="20"></iconify-icon>
              <span class="text-white text-sm font-medium">
                <span class="lang-ru">–õ–∏–¥–µ—Ä–±–æ—Ä–¥</span>
                <span class="lang-kz">“Æ–∑–¥—ñ–∫—Ç–µ—Ä —Ç—ñ–∑—ñ–º—ñ</span>
              </span>
            </button>
            <button onclick="userStats.showStatsModal()"
              class="w-full flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-white/5 transition-colors text-left">
              <iconify-icon icon="lucide:bar-chart-2" class="text-gold-400" width="20"></iconify-icon>
              <span class="text-white text-sm font-medium">
                <span class="lang-ru">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span>
                <span class="lang-kz">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span>
              </span>
            </button>
            <button onclick="gameEngine.showLevelSelection()"
              class="w-full flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-white/5 transition-colors text-left">
              <iconify-icon icon="lucide:settings-2" class="text-gold-400" width="20"></iconify-icon>
              <span class="text-white text-sm font-medium">
                <span class="lang-ru">–°–º–µ–Ω–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å</span>
                <span class="lang-kz">–î–µ“£–≥–µ–π–¥—ñ ”©–∑–≥–µ—Ä—Ç—É</span>
              </span>
            </button>
            <button onclick="toggleAchievementsPanel()"
              class="w-full flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-white/5 transition-colors text-left">
              <iconify-icon icon="lucide:trophy" class="text-gold-400" width="20"></iconify-icon>
              <span class="text-white text-sm font-medium">
                <span class="lang-ru">–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</span>
                <span class="lang-kz">–ñ–µ—Ç—ñ—Å—Ç—ñ–∫—Ç–µ—Ä</span>
              </span>
            </button>
            <button onclick="openFeedbackForm()"
              class="w-full flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-white/5 transition-colors text-left">
              <iconify-icon icon="lucide:message-square" class="text-blue-400" width="20"></iconify-icon>
              <span class="text-white text-sm font-medium">
                <span class="lang-ru">–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å</span>
                <span class="lang-kz">–ö–µ—Ä—ñ –±–∞–π–ª–∞–Ω—ã—Å</span>
              </span>
            </button>
            <button
              onclick="soundEffects.toggle(); this.querySelector('iconify-icon').setAttribute('icon', soundEffects.enabled ? 'lucide:volume-2' : 'lucide:volume-x')"
              class="w-full flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-white/5 transition-colors text-left">
              <iconify-icon icon="lucide:volume-2" class="text-gold-400" width="20"></iconify-icon>
              <span class="text-white text-sm font-medium">
                <span class="lang-ru">–ó–≤—É–∫–∏</span>
                <span class="lang-kz">–î—ã–±—ã—Å—Ç–∞—Ä</span>
              </span>
            </button>
            <a href="investors.html" target="_blank"
              class="w-full flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-white/5 transition-colors">
              <iconify-icon icon="lucide:briefcase" class="text-gold-400" width="20"></iconify-icon>
              <span class="text-white text-sm font-medium">
                <span class="lang-ru">–ò–Ω–≤–µ—Å—Ç–æ—Ä–∞–º</span>
                <span class="lang-kz">–ò–Ω–≤–µ—Å—Ç–æ—Ä–ª–∞—Ä“ì–∞</span>
              </span>
            </a>
          </div>
        </aside>

        <!-- Main Area -->
        <div class="lg:col-span-9 space-y-6">
          <!-- Welcome Banner -->
          <div class="glass rounded-2xl p-8 relative overflow-hidden">
            <div
              class="absolute top-0 right-0 w-64 h-64 bg-gold-500/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2">
            </div>
            <div class="relative">
              <h2 class="text-2xl md:text-3xl font-bold text-white mb-2">
                <span class="lang-ru">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, –ë–∞—Ç—ã—Ä!</span>
                <span class="lang-kz">“ö–æ—à –∫–µ–ª–¥—ñ“£, –ë–∞—Ç—ã—Ä!</span>
              </h2>
              <p class="text-zinc-400 mb-6 max-w-xl">
                <span class="lang-ru">–ò–∑—É—á–∞–π –∏—Å—Ç–æ—Ä–∏—é –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞ —á–µ—Ä–µ–∑ —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ –º–∏—Å—Å–∏–∏ –∏ —Å—Ç–∞–Ω–æ–≤–∏—Å—å –Ω–∞—Å—Ç–æ—è—â–∏–º –≥–µ—Ä–æ–µ–º
                  —Å—Ç–µ–ø–∏.</span>
                <span class="lang-kz">“ö—ã–∑—ã“õ—Ç—ã –º–∏—Å—Å–∏—è–ª–∞—Ä –∞—Ä“õ—ã–ª—ã “ö–∞–∑–∞“õ—Å—Ç–∞–Ω —Ç–∞—Ä–∏—Ö—ã–Ω “Ø–π—Ä–µ–Ω—ñ–ø, –¥–∞–ª–∞–Ω—ã“£ –Ω–∞“ì—ã–∑ –±–∞—Ç—ã—Ä—ã
                  –±–æ–ª.</span>
              </p>
              <button id="missions-btn" onclick="openCharacterSelection()"
                class="btn-primary px-8 py-4 rounded-xl text-base flex items-center gap-3 pulse-gold">
                <iconify-icon icon="lucide:play" width="20"></iconify-icon>
                <span class="lang-ru">–ù–∞—á–∞—Ç—å –º–∏—Å—Å–∏—é</span>
                <span class="lang-kz">–ú–∏—Å—Å–∏—è–Ω—ã –±–∞—Å—Ç–∞—É</span>
              </button>
            </div>
          </div>

          <!-- Mission Content Area -->
          <div id="mission-content" class="glass rounded-2xl p-8 min-h-[400px] flex items-center justify-center">
            <div class="text-center">
              <iconify-icon icon="lucide:compass" class="text-zinc-600" width="64"></iconify-icon>
              <p class="text-zinc-500 mt-4">
                <span class="lang-ru">–ù–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å –º–∏—Å—Å–∏—é" —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ</span>
                <span class="lang-kz">"–ú–∏—Å—Å–∏—è–Ω—ã –±–∞—Å—Ç–∞—É" –±–∞—Ç—ã—Ä–º–∞—Å—ã–Ω –±–∞—Å—ã“£—ã–∑</span>
              </p>
            </div>
          </div>

          <!-- Mission Questions Area -->
          <div id="mission-questions" class="hidden glass rounded-2xl p-8">
            <h3 class="text-xl font-bold text-white mb-6">
              <span class="lang-ru">–í–æ–ø—Ä–æ—Å—ã –ø–æ —Ç–µ–º–µ</span>
              <span class="lang-kz">–¢–∞“õ—ã—Ä—ã–ø –±–æ–π—ã–Ω—à–∞ —Å“±—Ä–∞“õ—Ç–∞—Ä</span>
            </h3>
            <div id="mission-questions-list" class="space-y-4"></div>
            
            <!-- Answer Form -->
            <form id="answer-form" class="mt-6">
              <button type="submit" class="w-full py-4 btn-primary rounded-xl text-base font-medium">
                <span class="lang-ru">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç—ã</span>
                <span class="lang-kz">–ñ–∞—É–∞–ø—Ç–∞—Ä–¥—ã –∂—ñ–±–µ—Ä—É</span>
              </button>
            </form>
          </div>

          <!-- Questions Area -->
          <div id="questions-container" class="hidden glass rounded-2xl p-8">
            <h3 class="text-xl font-bold text-white mb-6">
              <span class="lang-ru">–í–æ–ø—Ä–æ—Å—ã –ø–æ —Ç–µ–º–µ</span>
              <span class="lang-kz">–¢–∞“õ—ã—Ä—ã–ø –±–æ–π—ã–Ω—à–∞ —Å“±—Ä–∞“õ—Ç–∞—Ä</span>
            </h3>
            <div id="questions-list" class="space-y-4"></div>
          </div>
        </div>
      </div>
    </main>
  </section>

  <!-- Profile Modal -->
  <div id="profile-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center bg-black/80 p-4">
    <div class="glass rounded-2xl max-w-md w-full p-6">
      <div class="flex justify-between items-center mb-6">
        <h3 class="text-xl font-bold text-white">
          <span class="lang-ru">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</span>
          <span class="lang-kz">–ü—Ä–æ—Ñ–∏–ª—å–¥—ñ ”©“£–¥–µ—É</span>
        </h3>
        <button onclick="closeProfileModal()" class="text-zinc-400 hover:text-white">
          <iconify-icon icon="lucide:x" width="24"></iconify-icon>
        </button>
      </div>
      <form id="profile-edit-form" class="space-y-4">
        <div>
          <label class="block text-sm text-zinc-400 mb-2">
            <span class="lang-ru">–ò–º—è</span>
            <span class="lang-kz">–ê—Ç—ã</span>
          </label>
          <input type="text" id="profile-name"
            class="w-full px-4 py-3 bg-zinc-900/50 border border-white/10 rounded-xl text-white focus:border-gold-500/50 focus:outline-none">
        </div>
        <div>
          <label class="block text-sm text-zinc-400 mb-2">Email</label>
          <input type="email" id="profile-email"
            class="w-full px-4 py-3 bg-zinc-900/50 border border-white/10 rounded-xl text-white focus:border-gold-500/50 focus:outline-none">
        </div>
        <div>
          <label class="block text-sm text-zinc-400 mb-2">
            <span class="lang-ru">–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</span>
            <span class="lang-kz">–ñ–∞“£–∞ “õ“±–ø–∏—è —Å”©–∑</span>
          </label>
          <input type="password" id="profile-password"
            class="w-full px-4 py-3 bg-zinc-900/50 border border-white/10 rounded-xl text-white focus:border-gold-500/50 focus:outline-none"
            placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
        </div>
        <button type="submit" class="w-full py-3 btn-primary rounded-xl">
          <span class="lang-ru">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</span>
          <span class="lang-kz">–°–∞“õ—Ç–∞—É</span>
        </button>
      </form>
    </div>
  </div>

  <!-- Duel Modal -->
  <div id="duel-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center bg-black/80 p-4">
    <div class="glass rounded-2xl max-w-md w-full p-6">
      <div class="flex justify-between items-center mb-6">
        <h3 class="text-xl font-bold text-white">
          <span class="lang-ru">–í—ã–∑–≤–∞—Ç—å –Ω–∞ –¥—É—ç–ª—å</span>
          <span class="lang-kz">–î—É—ç–ª—å–≥–µ —à–∞“õ—ã—Ä—É</span>
        </h3>
        <button onclick="closeDuelModal()" class="text-zinc-400 hover:text-white">
          <iconify-icon icon="lucide:x" width="24"></iconify-icon>
        </button>
      </div>
      <div class="space-y-4">
        <p class="text-zinc-400 text-sm">
          <span class="lang-ru">–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ email –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞:</span>
          <span class="lang-kz">“ö–∞—Ä—Å—ã–ª–∞—Å—Ç—ã“£ –∞—Ç—ã–Ω –Ω–µ–º–µ—Å–µ email-—ñ–Ω –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑:</span>
        </p>
        <input type="text" id="duel-target"
          class="w-full px-4 py-3 bg-zinc-900/50 border border-white/10 rounded-xl text-white focus:border-gold-500/50 focus:outline-none"
          placeholder="@user or email">
        <button onclick="sendDuelChallenge()"
          class="w-full py-3 bg-red-600 hover:bg-red-700 text-white font-bold rounded-xl transition-colors">
          <span class="lang-ru">üèÅ –ë—Ä–æ—Å–∏—Ç—å –≤—ã–∑–æ–≤</span>
          <span class="lang-kz">üèÅ –®–∞“õ—ã—Ä—É –∂—ñ–±–µ—Ä—É</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Clan Modal -->
  <div id="clan-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center bg-black/80 p-4">
    <div class="glass rounded-2xl max-w-lg w-full p-6 max-h-[80vh] overflow-y-auto">
      <div class="flex justify-between items-center mb-6">
        <h3 class="text-xl font-bold text-white">
          <span class="lang-ru">–ö–ª–∞–Ω—ã (–†—É)</span>
          <span class="lang-kz">–ö–ª–∞–Ω (–†—É)</span>
        </h3>
        <button onclick="closeClanModal()" class="text-zinc-400 hover:text-white">
          <iconify-icon icon="lucide:x" width="24"></iconify-icon>
        </button>
      </div>

      <div class="grid grid-cols-2 gap-2 mb-8 p-1 bg-zinc-900/50 rounded-xl">
        <button onclick="showClanTab('list')" id="clan-tab-list"
          class="flex-1 py-2 text-sm font-medium rounded-lg bg-gold-500 text-black">
          <span class="lang-ru">–°–ø–∏—Å–æ–∫</span>
          <span class="lang-kz">–¢—ñ–∑—ñ–º</span>
        </button>
        <button onclick="showClanTab('create')" id="clan-tab-create"
          class="flex-1 py-2 text-sm font-medium rounded-lg text-zinc-400">
          <span class="lang-ru">–°–æ–∑–¥–∞—Ç—å</span>
          <span class="lang-kz">“ö“±—Ä—É</span>
        </button>
      </div>

      <!-- Clan List -->
      <div id="clan-list-section" class="space-y-4">
        <div id="clan-list-container" class="space-y-3">
          <!-- Clans will be loaded here -->
          <p class="text-center text-zinc-500 py-4">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
        </div>
      </div>

      <!-- Create Clan -->
      <div id="clan-create-section" class="hidden space-y-4">
        <div>
          <label class="block text-sm text-zinc-400 mb-2">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∞–Ω–∞</label>
          <input type="text" id="new-clan-name"
            class="w-full px-4 py-3 bg-zinc-900/50 border border-white/10 rounded-xl text-white focus:border-gold-500/50 focus:outline-none"
            placeholder="–ù–∞–ø—Ä: –ê–ª—Ç—ã–Ω –û—Ä–¥–∞">
        </div>
        <button onclick="handleCreateClan()" class="w-full py-3 btn-primary rounded-xl">
          <span class="lang-ru">üíé –°–æ–∑–¥–∞—Ç—å –∫–ª–∞–Ω</span>
          <span class="lang-kz">üíé –ö–ª–∞–Ω “õ“±—Ä—É</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Message Toast -->
  <div id="message-toast" class="fixed bottom-6 right-6 z-50 hidden">
    <div class="glass rounded-xl px-6 py-4 flex items-center gap-3">
      <iconify-icon id="toast-icon" icon="lucide:check-circle" class="text-green-400" width="24"></iconify-icon>
      <span id="toast-text" class="text-white"></span>
    </div>
  </div>

  <script>
    // Tab switching
    function showTab(tab) {
      const loginForm = document.getElementById('login-form');
      const registerForm = document.getElementById('register-form');
      const tabLogin = document.getElementById('tab-login');
      const tabRegister = document.getElementById('tab-register');

      if (tab === 'login') {
        loginForm.classList.remove('hidden');
        registerForm.classList.add('hidden');
        tabLogin.classList.add('bg-gold-500', 'text-black');
        tabLogin.classList.remove('text-zinc-400');
        tabRegister.classList.remove('bg-gold-500', 'text-black');
        tabRegister.classList.add('text-zinc-400');
      } else {
        loginForm.classList.add('hidden');
        registerForm.classList.remove('hidden');
        tabRegister.classList.add('bg-gold-500', 'text-black');
        tabRegister.classList.remove('text-zinc-400');
        tabLogin.classList.remove('bg-gold-500', 'text-black');
        tabLogin.classList.add('text-zinc-400');
      }
    }

    // Language switching
    function switchLanguage(lang) {
      document.body.dataset.language = lang;

      // Update all language buttons
      const ruBtns = document.querySelectorAll('[id^="btn-ru"]');
      const kzBtns = document.querySelectorAll('[id^="btn-kz"]');

      ruBtns.forEach(btn => {
        if (lang === 'ru') {
          btn.classList.add('bg-gold-500', 'text-black');
          btn.classList.remove('text-zinc-400', 'bg-zinc-800');
        } else {
          btn.classList.remove('bg-gold-500', 'text-black');
          btn.classList.add('text-zinc-400');
        }
      });

      kzBtns.forEach(btn => {
        if (lang === 'kz') {
          btn.classList.add('bg-gold-500', 'text-black');
          btn.classList.remove('text-zinc-400', 'bg-zinc-800');
        } else {
          btn.classList.remove('bg-gold-500', 'text-black');
          btn.classList.add('text-zinc-400');
        }
      });

      if (window.gameIntegration) {
        window.gameIntegration.userProfile.language = lang === 'kz' ? 'kk' : 'ru';
      }
    }

    // Auth functions
    function showGame() {
      document.getElementById('auth').classList.add('hidden');
      document.getElementById('game').classList.remove('hidden');
      updateStats();

      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—ã–±—Ä–∞–Ω –ª–∏ —É—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
      if (typeof gameEngine !== 'undefined') {
        const savedLevel = localStorage.getItem('batyrbol_difficulty');
        if (!savedLevel) {
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –≤—ã–±–æ—Ä–∞ —É—Ä–æ–≤–Ω—è
          setTimeout(() => gameEngine.showLevelSelection(), 300);
        }
      }
    }

    function logout() {
      window.authManager.logout();
    }

    function openProfileModal() {
      document.getElementById('profile-modal').classList.remove('hidden');
    }

    function closeProfileModal() {
      document.getElementById('profile-modal').classList.add('hidden');
    }

    function showMessage(text, type = 'success') {
      const toast = document.getElementById('message-toast');
      const icon = document.getElementById('toast-icon');
      const textEl = document.getElementById('toast-text');

      textEl.textContent = text;
      icon.setAttribute('icon', type === 'success' ? 'lucide:check-circle' : 'lucide:alert-circle');
      icon.className = type === 'success' ? 'text-green-400' : 'text-red-400';

      toast.classList.remove('hidden');
      setTimeout(() => toast.classList.add('hidden'), 3000);
    }

    function updateStats() {
      if (typeof achievementsInstance !== 'undefined' && achievementsInstance) {
        const stats = achievementsInstance.userStats;

        document.getElementById('user-xp').textContent = stats.total_points;
        document.getElementById('header-xp').textContent = stats.total_points;
        document.getElementById('user-level').textContent = stats.level;
        document.getElementById('user-level-badge').textContent = stats.level;
        document.getElementById('header-streak').textContent = stats.current_streak;
        document.getElementById('stat-missions').textContent = stats.missions_completed;
        document.getElementById('stat-correct').textContent = stats.correct_answers;
        document.getElementById('stat-streak').textContent = stats.best_streak;
        document.getElementById('stat-achievements').textContent = achievementsInstance.userAchievements.length;

        const xpProgress = Math.min(100, (stats.total_points % 100));
        document.getElementById('xp-bar').style.width = xpProgress + '%';
      }
    }

    // Form handlers
    document.getElementById('login-form').addEventListener('submit', async function (e) {
      e.preventDefault();
      const email = document.getElementById('login-email').value;
      const password = document.getElementById('login-password').value;

      // Use auth manager for login
      const result = await window.authManager.login(email, password);
      
      if (result.success) {
        showMessage('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!');
      } else {
        showMessage(result.message, 'error');
      }
    });

    document.getElementById('register-form').addEventListener('submit', async function (e) {
      e.preventDefault();
      showMessage('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∞. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç: test@batyrbol.kz / batyr123', 'error');
    });

    document.getElementById('profile-edit-form').addEventListener('submit', async function (e) {
      e.preventDefault();
      const name = document.getElementById('profile-name').value;
      const email = document.getElementById('profile-email').value;
      const password = document.getElementById('profile-password').value;

      if (window.gameIntegration) {
        try {
          await window.gameIntegration.updateUserProfile(name, email, password);
          document.getElementById('user-name').textContent = name;
          closeProfileModal();
          showMessage('–ü—Ä–æ—Ñ–∏–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω!');
        } catch (err) {
          showMessage(err.message, 'error');
        }
      }
    });

    // Achievements panel
    function toggleAchievementsPanel() {
      let panel = document.getElementById('achievements-modal');

      if (!panel) {
        panel = document.createElement('div');
        panel.id = 'achievements-modal';
        panel.className = 'fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4';
        panel.innerHTML = `
      <div class="glass rounded-2xl max-w-lg w-full max-h-[80vh] overflow-y-auto">
        <div class="p-6 border-b border-white/10 flex justify-between items-center sticky top-0 glass">
          <h2 class="text-xl font-bold text-white">üèÜ <span class="lang-ru">–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</span><span class="lang-kz">–ñ–µ—Ç—ñ—Å—Ç—ñ–∫—Ç–µ—Ä</span></h2>
          <button onclick="closeAchievementsPanel()" class="text-zinc-400 hover:text-white">
            <iconify-icon icon="lucide:x" width="24"></iconify-icon>
          </button>
        </div>
        <div id="achievements-content" class="p-6"></div>
      </div>
    `;
        document.body.appendChild(panel);
      } else {
        panel.classList.toggle('hidden');
      }

      if (typeof AchievementsUI !== 'undefined' && achievementsInstance) {
        const ui = new AchievementsUI(achievementsInstance);
        ui.render('achievements-content');
      }
    }

    function closeAchievementsPanel() {
      const panel = document.getElementById('achievements-modal');
      if (panel) panel.classList.add('hidden');
    }

    // Feedback form function
    function openFeedbackForm() {
      // Open Google Form in new tab
      window.open('https://forms.gle/7eoXJwsyR9wMgxiF6', '_blank');

      // Show confirmation message
      showMessage('–°–ø–∞—Å–∏–±–æ! –û–ø—Ä–æ—Å –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ', 'success');
    }

    // Duel Modal Functions
    function openDuelModal() {
      document.getElementById('duel-modal').classList.remove('hidden');
    }
    function closeDuelModal() {
      document.getElementById('duel-modal').classList.add('hidden');
    }
    async function sendDuelChallenge() {
      const target = document.getElementById('duel-target').value;
      if (!target) return showMessage('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∏–ª–∏ email', 'error');

      try {
        const resp = await fetch('/api/duels/challenge', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ from: window.gameIntegration.userProfile.email, to: target })
        });
        const data = await resp.json();
        if (data.success) {
          showMessage(data.message);
          closeDuelModal();
        }
      } catch (err) { showMessage(err.message, 'error'); }
    }

    // Clan Modal Functions
    function openClanModal() {
      document.getElementById('clan-modal').classList.remove('hidden');
      loadClans();
    }
    function closeClanModal() {
      document.getElementById('clan-modal').classList.add('hidden');
    }
    function showClanTab(tab) {
      const listBtn = document.getElementById('clan-tab-list');
      const createBtn = document.getElementById('clan-tab-create');
      const listSec = document.getElementById('clan-list-section');
      const createSec = document.getElementById('clan-create-section');

      if (tab === 'list') {
        listSec.classList.remove('hidden');
        createSec.classList.add('hidden');
        listBtn.classList.add('bg-gold-500', 'text-black');
        listBtn.classList.remove('text-zinc-400');
        createBtn.classList.remove('bg-gold-500', 'text-black');
        createBtn.classList.add('text-zinc-400');
        loadClans();
      } else {
        listSec.classList.add('hidden');
        createSec.classList.remove('hidden');
        createBtn.classList.add('bg-gold-500', 'text-black');
        createBtn.classList.remove('text-zinc-400');
        listBtn.classList.remove('bg-gold-500', 'text-black');
        listBtn.classList.add('text-zinc-400');
      }
    }

    async function loadClans() {
      const container = document.getElementById('clan-list-container');
      try {
        const resp = await fetch('/api/clans/list');
        const data = await resp.json();
        const clans = data.clans || {};

        if (Object.keys(clans).length === 0) {
          container.innerHTML = '<p class="text-center text-zinc-500 py-4">–ö–ª–∞–Ω–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</p>';
          return;
        }

        container.innerHTML = Object.entries(clans).map(([name, info]) => `
      <div class="glass p-4 rounded-xl flex items-center justify-between border border-white/5">
        <div>
          <h4 class="text-white font-bold">${name}</h4>
          <p class="text-zinc-500 text-xs">${info.members.length} —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ ‚Ä¢ ${info.xp} XP</p>
        </div>
        <button onclick="handleJoinClan('${name}')" class="px-4 py-2 bg-zinc-800 hover:bg-zinc-700 text-gold-400 rounded-lg text-sm font-medium transition-colors">
          –í—Å—Ç—É–ø–∏—Ç—å
        </button>
      </div>
    `).join('');
      } catch (err) { container.innerHTML = '<p class="text-red-400 text-center">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</p>'; }
    }

    async function handleCreateClan() {
      const name = document.getElementById('new-clan-name').value;
      if (!name) return showMessage('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∞–Ω–∞', 'error');

      try {
        const resp = await fetch('/api/clans/create', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email: window.gameIntegration.userProfile.email, name })
        });
        const data = await resp.json();
        if (data.success) {
          showMessage(data.message);
          showClanTab('list');
        } else { showMessage(data.message, 'error'); }
      } catch (err) { showMessage(err.message, 'error'); }
    }

    async function handleJoinClan(name) {
      try {
        const resp = await fetch('/api/clans/join', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email: window.authManager.getCurrentUser().email, name })
        });
        const data = await resp.json();
        if (data.success) {
          showMessage(data.message);
          closeClanModal();
        } else { showMessage(data.message, 'error'); }
      } catch (err) { showMessage(err.message, 'error'); }
    }

    // Initialize
    let achievementsInstance = null;

    document.addEventListener('DOMContentLoaded', function () {
      switchLanguage('kz');

      if (typeof initAchievements === 'function') {
        const { achievementsSystem } = initAchievements();
        achievementsInstance = achievementsSystem;
      }

      // Check for saved session
      const savedUser = localStorage.getItem('batyrbol_user');
      if (savedUser) {
        window.gameIntegration.showGameScreen();
      }

      setTimeout(updateStats, 500);

      // Register Service Worker for PWA
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/sw.js')
          .then(reg => console.log('SW registered'))
          .catch(err => console.log('SW error:', err));
      }
    });
  </script>

</body>

</html>